{"version":3,"file":"js/177.cc8ab411.js","mappings":"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","sources":["webpack://oficina-vue/./src/middlewares/setTokenMuni.js","webpack://oficina-vue/./src/views/AsignarPassword/AsignarPasswordView.vue","webpack://oficina-vue/./src/views/AsignarPassword/AsignarPasswordView.vue?4489"],"sourcesContent":["import axios from \"axios\";\r\nimport { BASE_URL } from \"@/env\";\r\nexport default function setTokenMuni() {\r\n  let refresh = localStorage.getItem(\"refreshToken\"); ///se toma el token refresh\r\n  const apiClient = axios.create({\r\n    baseURL: BASE_URL,\r\n    withCredentials: false,\r\n  });\r\n  apiClient\r\n    .post(\"/refresh-token-muni\", {\r\n      refreshToken: refresh,\r\n    })\r\n    .then((response) => {\r\n      localStorage.setItem(\"token\", response.data.Token);\r\n    })\r\n    .catch((error) => {\r\n      console.log(error.response, \"soy el error del refreshToken\");\r\n    });\r\n}\r\n","<template>\r\n  <div style=\"width: 100%\">\r\n    <div v-if=\"!this.loading\" class=\"container\">\r\n      <p>Ingrese su nueva contraseña:</p>\r\n      <div class=\"medio\">\r\n        <input\r\n          type=\"password\"\r\n          class=\"inputPassword\"\r\n          v-model=\"this.newPassword\"\r\n          @keyup=\"validation\"\r\n        />\r\n        <p v-if=\"this.error\">{{ this.error }}</p>\r\n        <button\r\n          type=\"button\"\r\n          class=\"btn btn-primary boton\"\r\n          @click=\"this.setPassword\"\r\n        >\r\n          Asignar\r\n        </button>\r\n        <p v-if=\"this.cambiado\">{{ this.cambiado }}</p>\r\n      </div>\r\n    </div>\r\n    <div v-if=\"this.loading\" class=\"spinner-border loading\" role=\"status\">\r\n      <span class=\"sr-only\"></span>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport setTokenMuni from \"@/middlewares/setTokenMuni\";\r\nimport { PASSWORD_HEADER, BASE_URL } from \"@/env\";\r\n\r\nexport default {\r\n  name: \"AsignarPasswordView\",\r\n  data() {\r\n    return {\r\n      newPassword: \"\",\r\n      loading: false,\r\n      error: \"\",\r\n      cambiado: null,\r\n      user: null,\r\n    };\r\n  },\r\n  created() {\r\n    this.loading = false;\r\n  },\r\n  methods: {\r\n    dispatchLogin() {\r\n      this.$store.dispatch(\"mockLoginAction\", this.user);\r\n    },\r\n    validation() {\r\n      let asd = /^(?=\\w*\\d)(?=\\w*[A-Z])(?=\\w*[a-z])\\S{8,16}$/;\r\n\r\n      if (!asd.test(this.newPassword)) {\r\n        this.error = \"Mínimo 8 caracteres, al menos una letra y un número:\";\r\n      } else {\r\n        this.error = \"\";\r\n      }\r\n    },\r\n    getMyProfile() {\r\n      const apiClient = axios.create({\r\n        baseURL: BASE_URL,\r\n        withCredentials: false,\r\n        headers: {\r\n          \"auth-header\": localStorage.getItem(\"token\"),\r\n          \"access-user-header\": PASSWORD_HEADER,\r\n        },\r\n      });\r\n      apiClient\r\n        .get(\"/municipales/muni-profile\")\r\n        .then((response) => {\r\n          console.log(response.data);\r\n          this.user = response.data.MuniProfile.muni;\r\n          this.dispatchLogin();\r\n          window.localStorage.setItem(\r\n            \"name\",\r\n            response.data.MuniProfile.muni.firstname\r\n          );\r\n          window.localStorage.setItem(\r\n            \"lastname\",\r\n            response.data.MuniProfile.muni.lastname\r\n          );\r\n          window.localStorage.setItem(\r\n            \"cuil\",\r\n            response.data.MuniProfile.muni.cuil\r\n          );\r\n          window.localStorage.setItem(\r\n            \"email\",\r\n            response.data.MuniProfile.muni.email\r\n          );\r\n          window.localStorage.setItem(\"id\", response.data.MuniProfile.muni.id);\r\n          window.localStorage.setItem(\r\n            \"fecha-creacion\",\r\n            response.data.MuniProfile.muni.created_at\r\n          );\r\n          window.localStorage.setItem(\r\n            \"role\",\r\n            response.data.MuniProfile.muni.role\r\n          );\r\n          this.$router.push(\"/muni\");\r\n        })\r\n        .catch((error) => {\r\n          if (error.response.status === 500) {\r\n            if (error.response.data.message === \"Token de usuario expirado\") {\r\n              setTokenMuni();\r\n              this.getMyProfile();\r\n            }\r\n          }\r\n        });\r\n    },\r\n    setPassword() {\r\n      const apiClient = axios.create({\r\n        baseURL: BASE_URL,\r\n        withCredentials: false,\r\n        headers: {\r\n          \"auth-header\": localStorage.getItem(\"token\"),\r\n        },\r\n      });\r\n      apiClient\r\n        .put(\"/municipales/change-first-time-password\", {\r\n          change_password: this.newPassword,\r\n        })\r\n        .then((response) => {\r\n          console.log(response);\r\n          if (response.status === 200) {\r\n            this.cambiado = response.data.message;\r\n            this.getMyProfile();\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n\r\n          if (error.response.status === 500) {\r\n            if (error.response.data.message === \"Token de usuario expirado\") {\r\n              setTokenMuni();\r\n              this.setPassword();\r\n            }\r\n          }\r\n        });\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.container {\r\n  width: 90%;\r\n  background: white;\r\n  padding: 2rem 0px;\r\n  border-radius: 20px;\r\n  margin-top: 10rem;\r\n}\r\nselect {\r\n  width: 50%;\r\n  margin-top: 1.5rem;\r\n  margin: auto;\r\n}\r\n.medio {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 10rem;\r\n}\r\n.medio input {\r\n  width: 50%;\r\n  margin: auto;\r\n  border-radius: 0px 10px;\r\n}\r\n.boton {\r\n  width: 30%;\r\n  margin: auto;\r\n}\r\n</style>\r\n","import { render } from \"./AsignarPasswordView.vue?vue&type=template&id=22cf9a2c&scoped=true\"\nimport script from \"./AsignarPasswordView.vue?vue&type=script&lang=js\"\nexport * from \"./AsignarPasswordView.vue?vue&type=script&lang=js\"\n\nimport \"./AsignarPasswordView.vue?vue&type=style&index=0&id=22cf9a2c&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\User 2\\\\OneDrive\\\\Escritorio\\\\oficina-virtuaL-Romi\\\\frontend-oficina-virtual\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-22cf9a2c\"]])\n\nexport default __exports__"],"names":["setTokenMuni","refresh","localStorage","getItem","apiClient","axios","baseURL","BASE_URL","withCredentials","post","refreshToken","then","response","setItem","data","Token","catch","error","console","log","style","class","_createElementVNode","role","_hoisted_8","_createElementBlock","_hoisted_1","loading","_hoisted_2","_hoisted_3","_hoisted_4","type","newPassword","onKeyup","$options","onClick","setPassword","cambiado","_hoisted_7","name","user","created","this","methods","dispatchLogin","$store","dispatch","validation","asd","test","getMyProfile","headers","PASSWORD_HEADER","get","MuniProfile","muni","window","firstname","lastname","cuil","email","id","created_at","$router","push","status","message","put","change_password","__exports__","render"],"sourceRoot":""}