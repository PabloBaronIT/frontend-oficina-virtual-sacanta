"use strict";(self["webpackChunkoficina_vue"]=self["webpackChunkoficina_vue"]||[]).push([[443],{1288:function(e,t,o){o.r(t),o.d(t,{default:function(){return Q}});var a=o(3396);const s={class:"form-container"};function n(e,t,o,n,i,l){const r=(0,a.up)("LoginComponent");return(0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(r)])}var i=o(7139),l=o.p+"img/LogoEnLineaBlanco.4cc37d52.svg",r=o.p+"img/LogoMuniBlanco.77386f7b.svg",c=o.p+"img/LogoCidi.04eeb0d6.png";const d=e=>((0,a.dD)("data-v-89b60ac2"),e=e(),(0,a.Cn)(),e),u={class:"contenedor"},g=d((()=>(0,a._)("div",{class:"boxDerechoMujer"},null,-1))),h={class:"boxIzquierdo"},m=d((()=>(0,a._)("div",{class:"logosMuni"},[(0,a._)("img",{src:l,alt:"logoMuni",class:"logo"}),(0,a._)("img",{src:r,alt:"",class:"logo"})],-1))),p=d((()=>(0,a._)("div",{class:"bienvenida"},[(0,a._)("h1",null,"¡BIENVENIDO!"),(0,a._)("p",null,[(0,a.Uk)(" Presentá aquí todos tus trámites y gestiones de manera rápida "),(0,a._)("br"),(0,a.Uk)(" y simple, sin horarios y desde el lugar que vos elijas. ")])],-1))),f={class:"internoBox"},k=d((()=>(0,a._)("h1",null,"INGRESÁ CON",-1))),w=d((()=>(0,a._)("button",{class:"btn btn-outline-secondary botonCidi"},[(0,a._)("a",{href:"https://cidi.test.cba.gov.ar/Cuenta/Login?app=551"},[(0,a._)("img",{src:c,alt:"imagen cidi"})])],-1))),b=d((()=>(0,a._)("h5",null,"Accedé a todos los trámites y servicios",-1))),v=d((()=>(0,a._)("div",{class:"linea"},null,-1))),C=d((()=>(0,a._)("h5",null,"También podés acceder sin usuario de CIDI",-1))),I=d((()=>(0,a._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"52",height:"52",viewBox:"0 0 56 56",fill:"none",class:"svgCirculo"},[(0,a._)("path",{d:"M27.7567 5.32361C15.3213 5.32361 5.2041 15.4408 5.2041 27.8762C5.2041 40.3116 15.3213 50.4288 27.7567 50.4288C40.1921 50.4288 50.3093 40.3116 50.3093 27.8762C50.3093 15.4408 40.1921 5.32361 27.7567 5.32361ZM22.3116 17.9899C23.6853 16.5338 25.6185 15.7325 27.7567 15.7325C29.8949 15.7325 31.8107 16.5392 33.1899 18.0029C34.5875 19.4862 35.2674 21.4791 35.1069 23.6216C34.786 27.8762 31.4898 31.3458 27.7567 31.3458C24.0236 31.3458 20.7209 27.8762 20.4065 23.6205C20.2471 21.4606 20.9259 19.4613 22.3116 17.9899ZM27.7567 46.9592C25.2092 46.9609 22.6873 46.451 20.3405 45.4598C17.9938 44.4685 15.87 43.0162 14.095 41.1888C15.1116 39.7391 16.4068 38.5065 17.9051 37.563C20.6689 35.7913 24.1667 34.8155 27.7567 34.8155C31.3467 34.8155 34.8445 35.7913 37.605 37.563C39.1046 38.506 40.401 39.7387 41.4184 41.1888C39.6436 43.0163 37.5198 44.4689 35.173 45.4601C32.8262 46.4513 30.3042 46.9611 27.7567 46.9592Z",fill:"#019939"})],-1))),y=d((()=>(0,a._)("p",null,"Accedé con servicios limitados",-1))),_=[I,y],S={key:0,class:"modalFormulario"},U={style:{width:"50%",margin:"auto"}},L={class:"error"},T={class:"botones"},P={type:"button",class:"btn btn-outline-secondary"},R=d((()=>(0,a._)("i",{class:"bi bi-facebook",style:{"font-size":"25px"}},null,-1)));function F(e,t,o,s,n,l){const r=(0,a.up)("FormKit"),c=(0,a.up)("router-link"),d=(0,a.up)("GoogleLogin");return(0,a.wg)(),(0,a.iD)("div",u,[g,(0,a._)("div",h,[m,p,(0,a._)("div",f,[k,w,b,v,C,(0,a._)("div",{class:"botonServicios",onClick:t[0]||(t[0]=()=>this.modalFormulario=!0)},_)])]),this.modalFormulario?((0,a.wg)(),(0,a.iD)("div",S,[(0,a._)("div",{onClick:t[1]||(t[1]=()=>this.modalFormulario=!1),style:{"font-size":"30px",position:"absolute",right:"2rem"}}," x "),(0,a._)("form",U,[(0,a.Wm)(r,{type:"form",id:"registration-example",actions:!1,"incomplete-message":"Aun no has completado todos los campos."},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:n.cuil,"onUpdate:modelValue":t[2]||(t[2]=e=>n.cuil=e),type:"number",name:"cuil",label:"CUIL",placeholder:"cuil",validation:"required|length:11,11|number","validation-messages":{required:"Ingresa el CUIL sin simbolos ni espacios",number:"Ingresar solo nùmeros",length:"El CUIL debe tener 11 caracteres"}},null,8,["modelValue"]),(0,a.Wm)(r,{modelValue:n.password,"onUpdate:modelValue":t[3]||(t[3]=e=>n.password=e),type:"password",name:"password",label:"Contraseña",placeholder:"clave"},null,8,["modelValue"]),(0,a._)("p",L,(0,i.zw)(this.msj),1)])),_:1})]),(0,a._)("div",T,[(0,a._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[4]||(t[4]=(...e)=>l.log&&l.log(...e))}," Ingresar "),(0,a._)("button",P,[(0,a.Wm)(c,{to:"/crear-cuenta"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Crear cuenta ")])),_:1})]),(0,a.Wm)(d,{callback:n.callback,prompt:""},null,8,["callback"]),(0,a._)("button",{class:"button face",onClick:t[5]||(t[5]=(...e)=>l.logInWithFacebook&&l.logInWithFacebook(...e))},[R,(0,a.Uk)(" Continuar con Facebook ")])])])):(0,a.kq)("",!0)])}o(7658);var x=o(70);o(2801);function E(e){this.message=e}E.prototype=new Error,E.prototype.name="InvalidCharacterError";var M="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new E("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,a,s=0,n=0,i="";a=t.charAt(n++);~a&&(o=s%4?64*o+a:a,s++%4)?i+=String.fromCharCode(255&o>>(-2*s&6)):0)a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a);return i};function Z(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(M(e).replace(/(.)/g,(function(e,t){var o=t.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o})))}(t)}catch(e){return M(t)}}function $(e){this.message=e}function B(e,t){if("string"!=typeof e)throw new $("Invalid token specified");var o=!0===(t=t||{}).header?0:1;try{return JSON.parse(Z(e.split(".")[o]))}catch(e){throw new $("Invalid token specified: "+e.message)}}$.prototype=new Error,$.prototype.name="InvalidTokenError";var j=B,q={getToken(e){let t=j(e);return t}},A=o(8713),D=o(5939),W=o(9306),V=o(6070),N={name:"LoginComponent",data(){return{face:null,cuil:null,password:"",validacion:!1,msj:"",loading:!1,user:null,representante:null,cidiCookie:null,datos:null,habilitado:null,callback:async e=>{event.preventDefault(),this.loading=!0;let t=(0,V.KQ)(e.credential);console.log("respuesta de google",t);const o=x.ZP.create({baseURL:W._n,withCredentials:!1,headers:{"auth-header":localStorage.getItem("token")}});o.post("/auth/signIn-providers",{firstname:t.given_name,lastname:t.family_name,email:t.email}).then((e=>{console.log(e.data);let t=e.data.accessToken,o=e.data.refreshToken,a=e.data["redirectURL"];localStorage.setItem("token",t),localStorage.setItem("refreshToken",o),this.getMyProfile(),a?(this.loading=!1,this.$router.push("micuenta-update")):(this.loading=!1,this.$router.push("munienlinea"))})).catch((e=>{this.loading=!1,this.msj=e.response.data.message,console.log(e.data)}))},datafacebook:"",modalFormulario:!1}},beforeRouteLeave(e,t,o){localStorage.clear(),o()},beforeRouteEnter(e,t,o){localStorage.clear(),o()},created(){localStorage.clear();let e=this.$route.query.cidi||null;console.log(e,"soy query de cidi");let t=document.cookie.split(";"),o=t?.map((e=>{if(e.includes("cidi"))return e})),a=o[0]?.split("=")||null;e&&(this.loading=!0,this.cidiCookie=e,document.cookie=`cidi=${e};max-age=120`,this.logCidi(e)),a&&(this.cidiCookie=a[1],this.loading=!0,this.logCidi(a[1]))},computed:{setPermission(){return!0===this.$store.state.loggedIn}},watch:{datafacebook(e){e&&this.getLogFace(e)}},methods:{async logInWithFacebook(){await this.loadFacebookSDK(document,"script","facebook-jssdk"),await this.initFacebook(),window.FB.login((e=>{"connected"==e.status&&window.FB.api("/me","GET",{fields:"id,name, email"},(e=>{console.log(e),this.datafacebook={name:e.name.split(" "),email:e.email},console.log(this.datafacebook,"soy los datos de face en un estado")}))}),{scope:"public_profile,email"})},getLogFace(e){console.log("estoy en getlogface");const t=x.ZP.create({baseURL:W._n,withCredentials:!1});t.post("/auth/signIn-providers",{firstname:e.name[0],lastname:e.name[1],email:e.email}).then((e=>{console.log(e.data);let t=e.data.accessToken,o=e.data.refreshToken,a=e.data["redirectURL"];localStorage.setItem("token",t),localStorage.setItem("refreshToken",o),this.getMyProfile(),a?(this.loading=!1,this.$router.push("micuenta-update")):(this.loading=!1,this.$router.push("munienlinea"))})).catch((e=>{this.loading=!1,this.msj=e.response.data.message,console.log(e.data)}))},async initFacebook(){window.fbAsyncInit=function(){window.FB.init({appId:"1235789680464916",cookie:!0,version:"v17.0"})}},async loadFacebookSDK(e,t,o){var a,s=e.getElementsByTagName(t)[0];e.getElementById(o)||(a=e.createElement(t),a.id=o,a.src="https://connect.facebook.net/en_US/sdk.js",s.parentNode.insertBefore(a,s))},dispatchLogin(){this.$store.dispatch("mockLoginAction",this.user)},dispatchCidi(){this.$store.dispatch("mockCidiAction",this.cidiCookie)},dispatchLoginPermission(){this.$store.dispatch("mockPaseAction")},dispatchRepresentante(){this.$store.dispatch("mockRepresentanteAction",this.representante)},log(){this.loading=!0;let e={cuil:this.cuil,password:this.password};const t=x.ZP.create({baseURL:"https://oficina-virtual-pablo-baron.up.railway.app",withCredentials:!1,headers:{"auth-header":localStorage.getItem("token")}});t.post("/auth/signin",e).then((e=>{console.log(e.data);let t=e.data.Tokens.authToken,o=e.data.Tokens.refreshToken;localStorage.setItem("token",t),localStorage.setItem("refreshToken",o),this.getMyProfile(),this.$router.push("munienlinea")})).catch((e=>{console.log(e),this.loading=!1,this.validacion=!1}))},logCidi(e){this.dispatchCidi(),console.log("entre en el logcidi");const t=x.ZP.create({baseURL:W._n,withCredentials:!1});t.post("/auth/cidi/login/"+e).then((e=>{console.log(e.data,"respuesta api cidi"),console.log("no hay respuesta de cidi");let t=e.data["Tokens"]||null,o=e.data["redirectURL"]||null,a=e.data["TokenRepresentations"]||null;if(t&&(localStorage.setItem("token",t.authToken),localStorage.setItem("refreshToken",t.refreshToken),this.getMyProfile(),this.$router.push("munienlinea")),o&&(window.location.href=e.data.redirectURL),a){localStorage.setItem("token",a.authToken),localStorage.setItem("refreshToken",a.refreshToken);let e=q.getToken(a.authToken),t=e.representative;localStorage.setItem("idRepresentante",t),this.getMyProfile(),this.getRepresentante(t),this.$router.push("munienlinea")}})).catch((e=>{console.log(e),this.msj="Usuario incorrecto",this.loading=!1})).finally((()=>{this.loading=!1}))},getMyProfile(){const e=x.ZP.create({baseURL:W._n,withCredentials:!1,headers:{"auth-header":localStorage.getItem("token")}});e.get("/oficina/user/profile").then((e=>{console.log(e.data,"datos de usuariodb"),this.user=e.data.UserProfile.user,this.user.cidiCookie=this.cidiCookie,this.dispatchLogin(),this.dispatchLoginPermission(),window.localStorage.setItem("role",e.data.UserProfile.user.role||null),window.localStorage.setItem("name",e.data.UserProfile.user.firstname||null),window.localStorage.setItem("lastname",e.data.UserProfile.user.lastname||null),window.localStorage.setItem("cuil",e.data.UserProfile.user.cuil||null),window.localStorage.setItem("adress",e.data.UserProfile.user.adress||null),window.localStorage.setItem("email",e.data.UserProfile.user.email||null),window.localStorage.setItem("id",e.data.UserProfile.user.id||null),window.localStorage.setItem("fecha-creacion",e.data.UserProfile.user.created_at||null),window.localStorage.setItem("nivel",e.data.UserProfile.user.level.level||null)})).catch((e=>{console.log(e),500===e.response.status&&("Token de usuario expirado"===e.response.data.message&&((0,A.Z)(),this.getMyProfile()),"Token de representante expirado"===e.response.data.message&&((0,D.Z)(),this.getMyProfile()))}))},getRepresentante(e){const t=x.ZP.create({baseURL:W._n,withCredentials:!1,headers:{"auth-header":localStorage.getItem("token"),"access-user-header":"^Yh19S&^8$yl01&Fagyg8eLxrI8uxypiCpdUdRscjF!xKSSqq"}});t.get("/oficina/users/"+e).then((e=>{console.log(e.data,"datos representante"),this.representante=e.data.User,localStorage.setItem("representanteFirstname",e.data.User.firstname),localStorage.setItem("representanteLastname",e.data.User.lastname),this.dispatchRepresentante()})).catch((t=>{console.log(t),500===t.response.status&&("Token de usuario expirado"===t.response.data.message&&((0,A.Z)(),this.getRepresentante(e)),"Token de representante expirado"===t.response.data.message&&((0,D.Z)(),this.getRepresentante(e)))}))}}},K=o(89);const z=(0,K.Z)(N,[["render",F],["__scopeId","data-v-89b60ac2"]]);var O=z,G={name:"LoginView",components:{LoginComponent:O},created(){localStorage.clear(),window.dispatchEvent(new CustomEvent("token-localstorage-changed",{detail:{storage:localStorage.getItem("token")}}))}};const J=(0,K.Z)(G,[["render",n],["__scopeId","data-v-7ae3aea1"]]);var Q=J}}]);
//# sourceMappingURL=about.176d9aa3.js.map