"use strict";(self["webpackChunkoficina_vue"]=self["webpackChunkoficina_vue"]||[]).push([[177],{3475:function(e,a,t){t.d(a,{Z:function(){return i}});var s=t(70),o=t(9306);function i(){let e=localStorage.getItem("refreshToken");const a=s.ZP.create({baseURL:o._n,withCredentials:!1});a.post("/refresh-token-muni",{refreshToken:e}).then((e=>{localStorage.setItem("token",e.data.Token)})).catch((e=>{console.log(e.response,"soy el error del refreshToken")}))}},177:function(e,a,t){t.r(a),t.d(a,{default:function(){return _}});var s=t(3396),o=t(9242),i=t(7139);const n=e=>((0,s.dD)("data-v-22cf9a2c"),e=e(),(0,s.Cn)(),e),r={style:{width:"100%"}},l={key:0,class:"container"},d=n((()=>(0,s._)("p",null,"Ingrese su nueva contraseña:",-1))),c={class:"medio"},u={key:0},h={key:1},w={key:1,class:"spinner-border loading",role:"status"},m=n((()=>(0,s._)("span",{class:"sr-only"},null,-1))),g=[m];function p(e,a,t,n,m,p){return(0,s.wg)(),(0,s.iD)("div",r,[this.loading?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",l,[d,(0,s._)("div",c,[(0,s.wy)((0,s._)("input",{type:"password",class:"inputPassword","onUpdate:modelValue":a[0]||(a[0]=e=>this.newPassword=e),onKeyup:a[1]||(a[1]=(...e)=>p.validation&&p.validation(...e))},null,544),[[o.nr,this.newPassword]]),this.error?((0,s.wg)(),(0,s.iD)("p",u,(0,i.zw)(this.error),1)):(0,s.kq)("",!0),(0,s._)("button",{type:"button",class:"btn btn-primary boton",onClick:a[2]||(a[2]=(...e)=>this.setPassword&&this.setPassword(...e))}," Asignar "),this.cambiado?((0,s.wg)(),(0,s.iD)("p",h,(0,i.zw)(this.cambiado),1)):(0,s.kq)("",!0)])])),this.loading?((0,s.wg)(),(0,s.iD)("div",w,g)):(0,s.kq)("",!0)])}t(7658);var f=t(70),P=t(3475),k=t(9306),v={name:"AsignarPasswordView",data(){return{newPassword:"",loading:!1,error:"",cambiado:null,user:null}},created(){this.loading=!1},methods:{dispatchLogin(){this.$store.dispatch("mockLoginAction",this.user)},validation(){let e=/^(?=\w*\d)(?=\w*[A-Z])(?=\w*[a-z])\S{8,16}$/;e.test(this.newPassword)?this.error="":this.error="Mínimo 8 caracteres, al menos una letra y un número:"},getMyProfile(){const e=f.ZP.create({baseURL:k._n,withCredentials:!1,headers:{"auth-header":localStorage.getItem("token"),"access-user-header":k.Zt}});e.get("/municipales/muni-profile").then((e=>{console.log(e.data),this.user=e.data.MuniProfile.muni,this.dispatchLogin(),window.localStorage.setItem("name",e.data.MuniProfile.muni.firstname),window.localStorage.setItem("lastname",e.data.MuniProfile.muni.lastname),window.localStorage.setItem("cuil",e.data.MuniProfile.muni.cuil),window.localStorage.setItem("email",e.data.MuniProfile.muni.email),window.localStorage.setItem("id",e.data.MuniProfile.muni.id),window.localStorage.setItem("fecha-creacion",e.data.MuniProfile.muni.created_at),window.localStorage.setItem("role",e.data.MuniProfile.muni.role),this.$router.push("/muni")})).catch((e=>{500===e.response.status&&"Token de usuario expirado"===e.response.data.message&&((0,P.Z)(),this.getMyProfile())}))},setPassword(){const e=f.ZP.create({baseURL:k._n,withCredentials:!1,headers:{"auth-header":localStorage.getItem("token")}});e.put("/municipales/change-first-time-password",{change_password:this.newPassword}).then((e=>{console.log(e),200===e.status&&(this.cambiado=e.data.message,this.getMyProfile())})).catch((e=>{console.log(e),500===e.response.status&&"Token de usuario expirado"===e.response.data.message&&((0,P.Z)(),this.setPassword())}))}}},y=t(89);const b=(0,y.Z)(v,[["render",p],["__scopeId","data-v-22cf9a2c"]]);var _=b}}]);
//# sourceMappingURL=177.cc8ab411.js.map