"use strict";(self["webpackChunkoficina_vue"]=self["webpackChunkoficina_vue"]||[]).push([[261],{1261:function(t,e,s){s.r(e),s.d(e,{default:function(){return qt}});var i=s(3396),o=s(7139);const a={key:0,class:"main-container"},n={class:"header"},l={class:"tituloPrincipal"};function r(t,e,s,r,u,p){const c=(0,i.up)("FormularioComponent");return p.setPermission?((0,i.wg)(),(0,i.iD)("div",a,[(0,i._)("div",n,[(0,i._)("h2",l,(0,o.zw)(this.$route.params.formularioTitle),1)]),this.preguntas?((0,i.wg)(),(0,i.j4)(c,{key:0,questionProp:this.preguntas,nivel:this.nivel,dispatchProcedure:this.dispatchProcedure,setProcedure:this.setProcedure,outProcedure:this.outProcedure},null,8,["questionProp","nivel","dispatchProcedure","setProcedure","outProcedure"])):(0,i.kq)("",!0)])):(0,i.kq)("",!0)}s(7658);var u=s(9242),p=s(1661),c=s(6385);const d=t=>((0,i.dD)("data-v-cac4ffbe"),t=t(),(0,i.Cn)(),t),h={class:"container"},g={key:0,class:"spinner-border",role:"status"},m=d((()=>(0,i._)("span",null,null,-1))),v=[m],f={key:1,class:"topquestion"},k=d((()=>(0,i._)("p",null,"Completar las preguntas",-1))),y={action:""},b=["v-if"],q={key:0,class:"tipoRadio"},w=["name","type","value"],x=["for"],_=d((()=>(0,i._)("br",null,null,-1))),I=["for"],P={key:1,class:"tipoTexto"},D={class:"option-text"},T=d((()=>(0,i._)("br",null,null,-1))),C={for:""},z=["type"],F={key:2,class:"tipoTexto"},S={class:"option-text"},O=d((()=>(0,i._)("br",null,null,-1))),$={for:""},L=["type"],Z={key:3,class:"tipoMap"},M=d((()=>(0,i._)("br",null,null,-1))),j={for:""},R={key:4,class:"file-container"},U={key:0,class:"file-intro"},V=d((()=>(0,i._)("img",{src:p,alt:"",id:"img-preview",class:"imgFile"},null,-1))),N=d((()=>(0,i._)("hr",null,null,-1))),Y=["type"],A={class:"fileup"},G={key:1,class:"cargado"},W=d((()=>(0,i._)("img",{src:c,alt:"",id:"img-preview",class:"imgFile"},null,-1))),H=d((()=>(0,i._)("p",null,"Archivo cargado",-1))),B=[W,H],E={class:"error"},K={class:"btn-div"},J={key:2,class:"alert alert-success text-center",role:"alert"},Q=d((()=>(0,i._)("h5",null,[(0,i.Uk)(" Gracias por utilizar la Oficina Virtual de la municipalidad de Sacanta! "),(0,i._)("h6",null,"Su reclamo ha sido presentado!")],-1))),X=[Q],tt={key:3},et={key:4,class:"btn-submit"};function st(t,e,s,a,n,l){const r=(0,i.up)("MapaLocationComponentVue");return(0,i.wg)(),(0,i.iD)("div",h,[this.loading?((0,i.wg)(),(0,i.iD)("div",g,v)):(0,i.kq)("",!0),this.preguntas?((0,i.wg)(),(0,i.iD)("div",f,[(0,i._)("h3",null,(0,o.zw)(this.preguntas[this.paso].question.title),1),k])):(0,i.kq)("",!0),(0,i._)("form",y,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(this.preguntas[this.paso].questionOption,((t,s)=>((0,i.wg)(),(0,i.iD)("div",{"v-if":this.preguntas[this.paso].questionOption?.length>=1&&this.paso>this.preguntas.length,key:t.id,class:"questions"},["radio"==t.type?((0,i.wg)(),(0,i.iD)("div",q,[(0,i.wy)((0,i._)("input",{name:this.preguntas[this.paso].question.title,type:t.type,"onUpdate:modelValue":e[0]||(e[0]=t=>this.selected=t),value:s+1},null,8,w),[[u.YZ,this.selected]]),(0,i._)("div",null,[(0,i._)("label",{for:t.title,class:"option-text"},(0,o.zw)(t.title),9,x),_,(0,i._)("label",{for:t.id,class:""},(0,o.zw)(t.description),9,I)])])):(0,i.kq)("",!0),"Indique la ubicación:"!==t.title&&"text"===t.type?((0,i.wg)(),(0,i.iD)("div",P,[(0,i._)("label",D,(0,o.zw)(t.title),1),T,(0,i._)("label",C,(0,o.zw)(t.description),1),(0,i.wy)((0,i._)("input",{class:"form-control text-number-input",type:t.type,"onUpdate:modelValue":e[1]||(e[1]=t=>this.textInput=t)},null,8,z),[[u.YZ,this.textInput]])])):(0,i.kq)("",!0),"Indique la ubicación:"!==t.title&&"number"===t.type?((0,i.wg)(),(0,i.iD)("div",F,[(0,i._)("label",S,(0,o.zw)(t.title),1),O,(0,i._)("label",$,(0,o.zw)(t.description),1),(0,i.wy)((0,i._)("input",{class:"form-control text-number-input",type:t.type,"onUpdate:modelValue":e[2]||(e[2]=t=>this.textInput=t)},null,8,L),[[u.YZ,this.textInput]])])):(0,i.kq)("",!0),"text"==t.type&&"Indique la ubicación:"==t.title?((0,i.wg)(),(0,i.iD)("div",Z,[(0,i._)("label",null,(0,o.zw)(t.title),1),M,(0,i._)("label",j,(0,o.zw)(t.description),1),(0,i.Wm)(r,{setTextInput:this.setTextInput},null,8,["setTextInput"])])):(0,i.kq)("",!0),"file"==t.type?((0,i.wg)(),(0,i.iD)("div",R,[n.asd?((0,i.wg)(),(0,i.iD)("div",G,B)):((0,i.wg)(),(0,i.iD)("div",U,[V,N,(0,i.wy)((0,i._)("input",{accept:".jpg, .jpeg, .png, .webp",type:t.type,"onUpdate:modelValue":e[3]||(e[3]=t=>this.fileSelect=t),id:"img-uploader",onChange:e[4]||(e[4]=t=>l.selectFile(t))},null,40,Y),[[u.YZ,this.fileSelect]]),(0,i._)("div",A,[this.fileSelect?((0,i.wg)(),(0,i.iD)("input",{key:0,class:"m-2 btn btn-secondary",type:"button",value:"Subir archivo",onClick:e[5]||(e[5]=t=>l.postFile())})):(0,i.kq)("",!0)])]))])):(0,i.kq)("",!0)],8,b)))),128)),(0,i.wy)((0,i._)("p",E," Debe seleccionar una opcion para continuar ",512),[[u.F8,0==n.validation]])]),(0,i._)("div",K,[this.paso+1<this.preguntas.length?((0,i.wg)(),(0,i.iD)("input",{key:0,class:"boton",type:"button",value:"Siguiente",onClick:e[6]||(e[6]=t=>l.preNext())})):(0,i.kq)("",!0),this.paso+1>1?((0,i.wg)(),(0,i.iD)("input",{key:1,class:"boton",type:"button",value:"Anterior",onClick:e[7]||(e[7]=t=>l.back())})):(0,i.kq)("",!0),(0,i._)("input",{class:"boton",type:"button",value:"Cancelar",onClick:e[8]||(e[8]=t=>l.cancel())})]),!0===this.servicio?((0,i.wg)(),(0,i.iD)("div",J,X)):(0,i.kq)("",!0),null!=this.mensaje?((0,i.wg)(),(0,i.iD)("div",tt,[(0,i._)("p",null,(0,o.zw)(this.mensaje),1)])):(0,i.kq)("",!0),this.paso+1==this.preguntas.length?((0,i.wg)(),(0,i.iD)("div",et,[this.paso+1==this.preguntas.length?((0,i.wg)(),(0,i.iD)("input",{key:0,class:"botonSubmit",type:"button",value:"Submitt",onClick:e[9]||(e[9]=(...t)=>l.submitt&&l.submitt(...t))})):(0,i.kq)("",!0)])):(0,i.kq)("",!0)])}var it=s(70),ot=s(8914),at=s(8713),nt=s(5939),lt=s(9306);const rt={style:{display:"flex","flex-direction":"column","justify-content":"space-around"}},ut=(0,i._)("p",null,"Indique la direccion en el mapa:",-1);function pt(t,e,s,o,a,n){const l=(0,i.up)("GMapMarker"),r=(0,i.up)("GMapMap");return(0,i.wg)(),(0,i.iD)("div",rt,[ut,(0,i.Wm)(r,{center:a.center,ref:"myMapRef",zoom:7,"map-type-id":"terrain",style:{width:"400px",height:"300px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(l,{position:this.markerPosition,clickable:!1,draggable:!0,onDragend:a.updateMarkerPosition},null,8,["position","onDragend"])])),_:1},8,["center"])])}var ct={name:"MapaLocation",props:{setTextInput:Function},data(){return{lat:"",lng:"",selectedLocation:null,center:{lat:"",lng:""},markerPosition:{lat:0,lng:0},updateMarkerPosition:t=>{this.markerPosition.lat=t.latLng.lat(),this.markerPosition.lng=t.latLng.lng(),this.asd()}}},created(){this.$getLocation().then((t=>{console.log(t,"coordiantes"),this.center.lat=t.lat,this.center.lng=t.lng,this.markerPosition.lat=t.lat,this.markerPosition.lng=t.lng})).catch((t=>{console.log(t)}))},methods:{asd(){this.setTextInput(this.markerPosition.lat.toFixed(7),this.markerPosition.lng.toFixed(7))}}},dt=s(89);const ht=(0,dt.Z)(ct,[["render",pt]]);var gt=ht,mt={name:"FormularioComponent",props:{questionProp:Array,nivel:Number,dispatchProcedure:Function,setProcedure:Function,outProcedure:Function},components:{MapaLocationComponentVue:gt},data(){return{modalReclamo:!1,paso:0,validation:null,loading:!1,textInput:"",coordenadas:"",selected:"",catId:null,file:null,fileSelect:null,asd:!1,preguntas:null,respuestas:[],servicio:!1,mensaje:null}},created(){this.loading=!0,this.setLoading(),console.log(this.nivel,"soy el nivel")},methods:{setTextInput(t,e){console.log(t,e,"soy las coordenadas");let s=`${t},${e}`;this.coordenadas=s},setModal(){this.modalReclamo=!this.modalReclamo},dispatchClean(){this.$store.dispatch("cleanAction")},preNext(){""==this.selected&&""==this.textInput&&""==this.coordenadas?this.validation=!1:(""!=this.selected&&""==this.textInput&&""==this.coordenadas||""==this.selected&&""!=this.textInput&&""==this.coordenadas||""==this.selected&&""==this.textInput&&""!=this.coordenadas||""==this.selected&&""!=this.textInput&&""!=this.coordenadas)&&this.next(),this.asd=!1},selectFile(t){const e=document.getElementById("img-preview");this.file=t.target.files[0];const s=URL.createObjectURL(this.file);e.src=s,console.log(this.file,"soy el archivo")},postFile:async function(){let t="lylceews",e="https://api.cloudinary.com/v1_1/ddko88otf/image/upload";const s=new FormData;s.append("file",this.file),s.append("upload_preset",t),await fetch(e,{method:"POST",body:s}).then((t=>t.json())).then((t=>{this.textInput=t.secure_url,this.asd=!0,console.log(this.textInput,"archivo cargado en textInput")})),this.fileSelect=null},next(){let t=this.selected-1,e="",s="",i="";if(""!=this.textInput&&""==this.coordenadas)e=this.textInput,t=0,i={question:this.preguntas[this.paso].question.id,question_option_history:[{questionOption:this.preguntas[this.paso].questionOption[t].id,answer:e}]};else if(""==this.textInput&&""!=this.coordenadas)e=this.coordenadas,t=1,i={question:this.preguntas[this.paso].question.id,question_option_history:[{questionOption:this.preguntas[this.paso].questionOption[t].id,answer:e}]};else if(""!=this.textInput&&""!=this.coordenadas){e=this.textInput,s=this.coordenadas,t=0;let o=1;i={question:this.preguntas[this.paso].question.id,question_option_history:[{questionOption:this.preguntas[this.paso].questionOption[t].id,answer:e},{questionOption:this.preguntas[this.paso].questionOption[o].id,answer:s}]}}else e=this.preguntas[this.paso].questionOption[t].title,i={question:this.preguntas[this.paso].question.id,question_option_history:[{questionOption:this.preguntas[this.paso].questionOption[t].id,answer:e}]};this.setProcedure(i),this.respuestas.push(i),console.log(this.respuestas,"!respuestas "),this.selected="",t=0,this.textInput="",this.coordenadas="",this.validation=!0,this.paso++},submitt(){if(0==this.selected&&""==this.textInput&&""==this.coordenadas?this.validation=!1:this.validation=!0,this.validation){this.preNext(),this.loading=!0;const t=it.ZP.create({baseURL:lt._n,withCredentials:!1,headers:{"auth-header":localStorage.getItem("token")}});t.post("/oficina/procedures/submit-procedure",{questions:this.respuestas,procedureId:parseInt(this.$route.params.formularioId)}).then((t=>{if(console.log(t),201==t.status){let e=t.data.procedure_history_id;2===this.nivel?this.$router.push(`/pago/${e}`):(this.textInput="",alert("Su reclamo fue presentado! Gracia por utilizar nuestra Oficina Virtual.")),this.dispatchClean(),this.dispatchProcedure()}})).catch((t=>{console.log(t),401==t.response.status&&(alert("No esta autorizado para realizar este tramite."),this.$router.replace({path:"/munienlinea"})),500===t.response.status?("Token de usuario expirado"===t.response.data.message&&((0,at.Z)(),this.submitt()),"Token de representante expirado"===t.response.data.message&&((0,nt.Z)(),this.submitt())):this.mensaje="Se ha producido un error, vuelva a interntarlo."})).finally((()=>{this.loading=!1})),this.loading=!1}},back(){this.paso--,this.outProcedure(),this.preguntas.pop()},cancel(){this.$router.replace({path:"/munienlinea"}),this.preguntas=[]},ver(){var t=new ot.kH;t.setTextColor(120,12,3),t.setFontSize(22),t.setTextColor(20),t.setFontSize(16),t.text(20,30,"This is some normal sized text underneath."),t.save("a4.pdf")},setLoading(){this.preguntas=this.questionProp,this.loading=!1}}};const vt=(0,dt.Z)(mt,[["render",st],["__scopeId","data-v-cac4ffbe"]]);var ft=vt,kt={title:"",procedureId:null,questions:[],fecha:(new Date).toLocaleDateString(),precio:""},yt={data(){return{category:this.$route.params,preguntas:"",nivel:""}},components:{FormularioComponent:ft},created(){this.getTemplate(),kt.questions=[]},methods:{setProcedure(t){kt.questions.push(t)},outProcedure(){kt.questions.pop()},back(){this.$router.go(-1)},dispatchProcedure(){this.$store.dispatch("saveP",kt)},getTemplate(){const t=it.ZP.create({baseURL:lt._n,withCredentials:!1,headers:{"auth-header":localStorage.getItem("token")}});t.get("/oficina/procedures/template/"+this.$route.params.formularioId).then((t=>{console.log(t.data),this.preguntas=t.data.Template.questionProcedure,this.nivel=t.data.Template.level.level,kt.procedureId=t.data.Template.id,kt.title=t.data.Template.title,kt.precio=t.data.Template.price})).catch((t=>{console.log(t),500===t.response.status&&("Token de usuario expirado"===t.response.data.message&&((0,at.Z)(),this.getTemplate()),"Token de representante expirado"===t.response.data.message&&((0,nt.Z)(),this.getTemplate())),401===t.response.status&&this.$router.push("micuenta-update")}))}},computed:{setPermission(){return!0===this.$store.state.loggedIn}}};const bt=(0,dt.Z)(yt,[["render",r],["__scopeId","data-v-bf5cc2d0"]]);var qt=bt},6385:function(t,e,s){t.exports=s.p+"img/red-check-mark-icon.dd8d0a39.svg"},1661:function(t,e,s){t.exports=s.p+"img/tramite-logo.2e93d658.svg"}}]);
//# sourceMappingURL=261.a5dcca42.js.map